<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Paiement</title>
<script src="https://www.paypal.com/sdk/js?client-id=AfUrubsCvRdT7fWJPaNImjSdiW0rKpxIvLO7Js8fwFYJK6tpZYDyqcUUY2u1E6ckodmgBEoy0OVSlzYU&currency=EUR"></script>
<style>
body{background:#111;color:#fff;text-align:center;font-family:Arial;padding-top:80px}
</style>
</head>
<body>

<h2>Paiement acompte 15€</h2>

<div id="paypal-button-container"></div>

<script>
const reservation=JSON.parse(localStorage.getItem("reservation"));

paypal.Buttons({

createOrder:(data,actions)=>{
return actions.order.create({
purchase_units:[{amount:{value:"15.00"}}]
});
},

onApprove:(data,actions)=>{
return actions.order.capture().then(async details=>{

reservation.paypal_order_id=data.orderID;

await fetch("https://storeflight-backend-1.onrender.com/api/reservations",{
method:"POST",
headers:{ "Content-Type":"application/json" },
body:JSON.stringify(reservation)
});

localStorage.removeItem("reservation");

document.body.innerHTML="<h1>Paiement réussi ✅</h1><p>Votre réservation a été enregistrée.</p>";

});
}

}).render("#paypal-button-container");
</script>

</body>
</html>
